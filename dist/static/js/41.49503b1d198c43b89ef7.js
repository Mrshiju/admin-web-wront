webpackJsonp([41],{Asji:function(e,a){},foSV:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var i=t("Xxa5"),n=t.n(i),s=t("BO1k"),l=t.n(s),o=t("exGp"),r=t.n(o),c={name:"admin_khsq",data:function(){return{userName:"",ischeck:"",options:[{label:"所有",value:""},{label:"未审核",value:0},{label:"审核通过",value:1},{label:"审核拒绝",value:2},{label:"已提交",value:3}],formData:new FormData,pageNum:1,pageSize:30,sum:0,index:0,tableData:[],checkIn:!0,loading:!1,addClientDataFlag:!1,addClientData:{userName:"",companyName:"",agentName:"",agentID:"",source:1,accountTpye:1,unitprice:"",nickName:"",mobile:"",businessLicense:"",contract:"",address:"",phone:"",qq:"",mail:"",accountID:"",isPCN:"",ischeckCn:"",remarks:"",id:""},modifyClientDataFlag:!1,modifyClientData:{userName:"",companyName:"",agentName:"",agentID:"",source:1,accountTpye:1,unitprice:"",nickName:"",mobile:"",businessLicense:"",contract:"",address:"",phone:"",qq:"",mail:"",accountID:"",isPCN:"",ischeckCn:"",remarks:"",id:""},rule1:{userName:[{required:!0,message:"请输入客户用户名",trigger:"blur"}],companyName:[{required:!0,message:"请输入公司名称",trigger:"blur"}],saleName:[{required:!0,message:"请选择指定销售",trigger:"change"}],nickName:[{required:!0,message:"请输入联系人",trigger:"blur"}],mobile:[{required:!0,message:"请输入联系电话",trigger:"blur"},{validator:this.validPhone,trigger:"blur"}],address:[{required:!0,message:"请输入联系地址",trigger:"blur"}],unitprice:[{required:!0,message:"请输入单价",trigger:"blur"},{type:"number",min:0,message:"请输入数字"}],businessLicense:[{required:!0,message:"营业执照不能为空",trigger:"blur"}],contract:[{required:!0,message:"合同不能为空",trigger:"blur"}]},sourceOpt:[{value:1,label:"web客户"},{value:2,label:"普通接口"},{value:3,label:"cmpp客户"}],accountTypeOpt:[{value:1,label:"行业短信"},{value:2,label:"营销短信"}],saleNameOpt:[],contract:"",Licensed:"",name:"",fileList1:[],fileList2:[],fileList3:[],fileList4:[],adminKhsqAdd:!1,restaurants:[],historyLists:[]}},methods:{querySearch:function(e,a){var t=this.restaurants;a(e?t.filter(this.createFilter(e)):t)},createFilter:function(e){return function(a){return 0===a.value.toLowerCase().indexOf(e.toLowerCase())}},handleSelect:function(e){console.log(e)},loadAll:function(){return this.historyLists},succeed:function(e){this.$message({message:e,type:"success"})},failed:function(e){this.$message.error(e)},modify:function(e){this.modifyClientDataFlag=!0;var a=this;this.postRequest("admin/findSaleCustomerInfo",{id:e.id}).then(function(e){a.modifyClientData={userName:e.data.data.saleCustomerInfo.userName,companyName:e.data.data.saleCustomerInfo.companyName,agentName:e.data.data.saleCustomerInfo.agentName,agentID:e.data.data.saleCustomerInfo.agentID,source:1,accountTpye:1,unitprice:Number(e.data.data.saleCustomerInfo.unitprice)/1e4,nickName:e.data.data.saleCustomerInfo.nickName,mobile:e.data.data.saleCustomerInfo.mobile,businessLicense:e.data.data.saleCustomerInfo.businessLicense,contract:e.data.data.saleCustomerInfo.contract,address:e.data.data.saleCustomerInfo.address,phone:e.data.data.saleCustomerInfo.phone?e.data.data.saleCustomerInfo.phone:"",qq:e.data.data.saleCustomerInfo.qq?e.data.data.saleCustomerInfo.qq:"",mail:e.data.data.saleCustomerInfo.mail,accountID:e.data.data.saleCustomerInfo.accountID,isPCN:e.data.data.saleCustomerInfo.isPCN,ischeckCn:e.data.data.saleCustomerInfo.ischeckCn,remarks:e.data.data.saleCustomerInfo.remarks,id:e.data.data.saleCustomerInfo.id}})},submitModifyClientData:function(){var e=this;this.modifyClientDataFlag=!1;var a=this;this.$refs.modifyClientForm.validate(function(t){t?e.postRequest("admin/updateSaleCustomerInfo",{id:e.modifyClientData.id,companyName:e.modifyClientData.companyName,source:e.modifyClientData.source,accountTpye:e.modifyClientData.accountTpye,saleName:window.sessionStorage.saleName,nickName:e.modifyClientData.nickName,mobile:e.modifyClientData.mobile,businessLicense:e.modifyClientData.businessLicense,contract:e.modifyClientData.contract,address:e.modifyClientData.address,phone:e.modifyClientData.phone,QQ:e.modifyClientData.qq,mail:e.modifyClientData.mail,unitprice:1e4*Number(e.modifyClientData.unitprice)}).then(function(e){a.checkData(),a.succeed("修改成功"),a.modifyClientData={companyName:"",agentName:"",agentID:"",source:1,accountTpye:1,nickName:"",mobile:"",businessLicense:"",contract:"",address:"",phone:"",qq:"",mail:"",accountID:""}}).catch(function(e){a.failed("修改失败，请联系后台")}):a.failed("修改失败，请联系后台")})},resetForm:function(e){this.addClientDataFlag=!1},fileChange:function(e,a,t){"success"===e.status&&(1===t?(this.$refs.uploadFile1.clearFiles(),this.fileList1=[{name:e.name,url:e.url}]):2===t?(this.$refs.uploadFile2.clearFiles(),this.fileList2=[{name:e.name,url:e.url}]):3===t?(this.$refs.uploadFile3.clearFiles(),this.fileList3=[{name:e.name,url:e.url}]):(this.$refs.uploadFile4.clearFiles(),this.fileList4=[{name:e.name,url:e.url}]))},contractsSize:function(e,a,t){this.contract=a.status},Licenseds:function(e,a,t){this.Licensed=a.status},submitAddClientData:function(){var e=this,a=this;this.$refs.addClientData.validate(function(t){t?(e.addClientDataFlag=!1,e.postRequest("admin/saveSaleCustomerInfo",{companyName:e.addClientData.companyName,source:e.addClientData.source,accountTpye:e.addClientData.accountTpye,saleName:window.sessionStorage.saleName,nickName:e.addClientData.nickName,mobile:e.addClientData.mobile,businessLicense:e.addClientData.businessLicense,contract:e.addClientData.contract,address:e.addClientData.address,phone:e.addClientData.phone,QQ:e.addClientData.qq,mail:e.addClientData.mail,unitprice:1e4*Number(e.addClientData.unitprice)}).then(function(e){a.resetForm(),a.checkData(),a.succeed(e.data.data),a.addClientData={companyName:"",agentName:"",agentID:"",source:1,accountTpye:1,nickName:"",mobile:"",businessLicense:"",contract:"",address:"",phone:"",qq:"",mail:"",accountID:""},a.$refs.uploadFile1.clearFiles(),a.$refs.uploadFile2.clearFiles()})):a.failed("请填写完整信息")})},handleClose:function(){this.addClientDataFlag=!1,this.addClientData={companyName:"",agentName:"",agentID:"",source:1,accountTpye:1,unitprice:"",nickName:"",mobile:"",businessLicense:"",contract:"",phone:"",qq:"",mail:"",accountID:"",isPCN:"",ischeckCn:"",remarks:""}},businessLicenseChange2:function(e){var a=this;this.formData.set("file",e.file),this.postRequest("admin/uploadPic",this.formData).then(function(t){a.addClientData.businessLicense=t.data.url,e.onSuccess(t.data)})},contractChange2:function(e){var a=this;this.formData.set("file",e.file),this.postRequest("admin/uploadPic",this.formData).then(function(t){a.addClientData.contract=t.data.url,e.onSuccess(t.data)})},businessLicenseChange1:function(e){var a=this;this.formData.set("file",e.file),this.postRequest("admin/uploadPic",this.formData).then(function(e){a.modifyClientData.businessLicense=e.data.url})},contractChange1:function(e){var a=this;this.formData.set("file",e.file),this.postRequest("admin/uploadPic",this.formData).then(function(e){a.modifyClientData.contract=e.data.url})},handleSizeChange:function(){this.checkData()},handlePageChange:function(){this.checkData()},getlistAllCustomers:function(){var e=this;return r()(n.a.mark(function a(){var t,i,s,o,r,c,u;return n.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e.postRequest("admin/listAllCustomers",{t:""});case 2:for(t=a.sent,i=!0,s=!1,o=void 0,a.prev=6,r=l()(t.data.data);!(i=(c=r.next()).done);i=!0)u=c.value,e.historyLists.push({value:u.userName});a.next=14;break;case 10:a.prev=10,a.t0=a.catch(6),s=!0,o=a.t0;case 14:a.prev=14,a.prev=15,!i&&r.return&&r.return();case 17:if(a.prev=17,!s){a.next=20;break}throw o;case 20:return a.finish(17);case 21:return a.finish(14);case 22:case"end":return a.stop()}},a,e,[[6,10,14,22],[15,,17,21]])}))()},checkData:function(){var e=this;this.tableData=[],this.checkIn=!0,this.loading=!0;var a=this;this.postRequest("admin/listAllSaleCustomerInfo",{userName:this.userName,ischeck:this.ischeck,saleName:window.sessionStorage.saleName}).then(function(t){a.tableData=[],a.loading=!1,e.index=Number(t.data.data.page.pageNum-1)*Number(t.data.data.page.pageSize)+1,a.sum=t.data.data.page.totalCount;var i=!0,n=!1,s=void 0;try{for(var o,r=l()(t.data.data.data);!(i=(o=r.next()).done);i=!0){var c=o.value;a.tableData.push({index:a.index,id:c.id,userName:c.userName,source:c.source,sourceCn:1===c.source?"web":2===c.source?"普通接口":3===c.source?"cmpp":31===c.source?"sgip":"smgp",unitprice:c.unitprice?Number(c.unitprice)/1e4:0,accountTpye:c.accountTpye,accountTpyeCn:1===c.accountTpye?"行业短信":"营销短信",businessLicense:c.businessLicense,contract:c.contract,isPCN:c.isPCN,ischeck:c.ischeck,ischeckCn:0===c.ischeck?"待审核":1===c.ischeck?"审核通过":2===c.ischeck?"审核拒绝":"已提交",mail:c.mail,mobile:c.mobile,nickName:c.nickName,phone:c.phone,qq:c.qq,remarks:c.remarks,companyName:c.companyName}),a.index++}}catch(e){n=!0,s=e}finally{try{!i&&r.return&&r.return()}finally{if(n)throw s}}})},checkButtonRole:function(){var e=this;this.postRequest("admin/clickShowCheck",{token:""}).then(function(a){if(a.data.success){var t=a.data.data.codes;e.adminKhsqAdd=t.includes("admin_khsq_add")}else e.failed()})},cancel:function(){},addClient:function(){this.addClientDataFlag=!0},close:function(e){this.modifyClientDataFlag=!1}},mounted:function(){var e=sessionStorage.getItem("saleName");this.name=e,this.restaurants=this.loadAll(),this.getlistAllCustomers()},created:function(){this.checkButtonRole()}},u={render:function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"container"},[t("el-form",{attrs:{"label-width":"120px",inline:"inline"},nativeOn:{keyup:function(a){return"button"in a||!e._k(a.keyCode,"enter",13,a.key,"Enter")?e.checkData(a):null}}},[t("el-form-item",{attrs:{label:"用户名："}},[t("el-autocomplete",{attrs:{"popper-class":"my-autocomplete","fetch-suggestions":e.querySearch,placeholder:"请输入用户名"},on:{select:e.handleSelect},scopedSlots:e._u([{key:"default",fn:function(a){var i=a.item;return[t("div",{staticClass:"name"},[e._v(e._s(i.value))]),e._v(" "),t("span",{staticClass:"addr"},[e._v(e._s(i.address))])]}}]),model:{value:e.userName,callback:function(a){e.userName=a},expression:"userName"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"状态："}},[t("el-select",{model:{value:e.ischeck,callback:function(a){e.ischeck=a},expression:"ischeck"}},e._l(e.options,function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),t("el-form-item",[t("el-button",{attrs:{type:"primary",plain:""},on:{click:e.checkData}},[e._v("查询")]),e._v(" "),e.adminKhsqAdd?t("el-button",{attrs:{type:"primary",plain:""},on:{click:e.addClient}},[e._v("添加客户")]):e._e()],1)],1),e._v(" "),e.checkIn?t("el-card",[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"table",attrs:{border:"",data:e.tableData,stripe:""}},[t("el-table-column",{attrs:{label:"序号",prop:"index"}}),e._v(" "),t("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(a){return[2===a.row.ischeck?t("el-button",{attrs:{type:"text"},on:{click:function(t){e.modify(a.row)}}},[e._v("修改信息")]):e._e()]}}])}),e._v(" "),t("el-table-column",{attrs:{prop:"companyName",label:"公司名称"}}),e._v(" "),t("el-table-column",{attrs:{prop:"userName",label:"客户名称"}}),e._v(" "),t("el-table-column",{attrs:{prop:"sourceCn",label:"客户来源"}}),e._v(" "),t("el-table-column",{attrs:{prop:"unitprice",label:"单价（元）"}}),e._v(" "),t("el-table-column",{attrs:{prop:"accountTpyeCn",label:"账号类型"}}),e._v(" "),t("el-table-column",{attrs:{prop:"ischeckCn",label:"审核状态"}}),e._v(" "),t("el-table-column",{attrs:{label:"营业执照",width:"150"},scopedSlots:e._u([{key:"default",fn:function(e){return e.row.businessLicense?[t("img",{directives:[{name:"image-preview",rawName:"v-image-preview"}],staticStyle:{width:"150px",height:"120px"},attrs:{src:e.row.businessLicense}})]:void 0}}])}),e._v(" "),t("el-table-column",{attrs:{label:"合同",width:"150"},scopedSlots:e._u([{key:"default",fn:function(e){return e.row.contract?[t("img",{directives:[{name:"image-preview",rawName:"v-image-preview"}],staticStyle:{width:"150px",height:"120px"},attrs:{src:e.row.contract}})]:void 0}}])})],1),e._v(" "),t("el-pagination",{staticClass:"fr",staticStyle:{margin:"10px 0"},attrs:{"current-page":e.pageNum,"page-size":e.pageSize,total:e.sum,layout:"sizes, prev, pager, next, jumper"},on:{"size-change":e.handleSizeChange,"current-change":e.handlePageChange,"update:currentPage":function(a){e.pageNum=a},"update:pageSize":function(a){e.pageSize=a}}}),e._v(" "),t("span",{staticClass:"fr",staticStyle:{"padding-top":"15px","font-size":"14px"}},[e._v("共"+e._s(e.sum)+"条，")])],1):e._e(),e._v(" "),t("el-dialog",{ref:"addClientData",attrs:{title:"添加客户申请",visible:e.addClientDataFlag,width:"500px"},on:{"update:visible":function(a){e.addClientDataFlag=a}}},[t("el-form",{ref:"addClientData",staticStyle:{width:"450px"},attrs:{inline:"inline",model:e.addClientData,rules:e.rule1,"label-width":"120px",action:"#",encytype:"multipart/form-data"}},[t("el-form-item",{attrs:{label:"公司名称：",prop:"companyName"}},[t("el-input",{attrs:{placeholder:"请输入公司名称全程"},model:{value:e.addClientData.companyName,callback:function(a){e.$set(e.addClientData,"companyName",a)},expression:"addClientData.companyName"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"客户来源："}},[t("el-select",{attrs:{filterable:""},model:{value:e.addClientData.source,callback:function(a){e.$set(e.addClientData,"source",a)},expression:"addClientData.source"}},e._l(e.sourceOpt,function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),t("el-form-item",{attrs:{label:"账号类型："}},[t("el-select",{attrs:{filterable:""},model:{value:e.addClientData.accountTpye,callback:function(a){e.$set(e.addClientData,"accountTpye",a)},expression:"addClientData.accountTpye"}},e._l(e.accountTypeOpt,function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),t("el-form-item",{attrs:{label:"单价(元)：",prop:"unitprice"}},[t("el-input",{model:{value:e.addClientData.unitprice,callback:function(a){e.$set(e.addClientData,"unitprice",e._n(a))},expression:"addClientData.unitprice"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"联系人：",prop:"nickName"}},[t("el-input",{model:{value:e.addClientData.nickName,callback:function(a){e.$set(e.addClientData,"nickName",a)},expression:"addClientData.nickName"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"联系电话：",prop:"mobile"}},[t("el-input",{model:{value:e.addClientData.mobile,callback:function(a){e.$set(e.addClientData,"mobile",a)},expression:"addClientData.mobile"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"营业执照：",prop:"businessLicense"}},[e.addClientData.businessLicense?t("img",{staticStyle:{width:"220px",height:"400px"},attrs:{src:e.addClientData.businessLicense,alt:"营业执照"}}):e._e(),e._v(" "),t("el-upload",{ref:"uploadFile1",attrs:{action:"",accept:".jpg, .png, .word","on-change":function(a,t){return e.fileChange(a,t,1)},"http-request":e.businessLicenseChange2,"file-list":e.fileList1,id:"businessLicense","on-success":e.Licenseds}},[t("el-button",[e._v("上传")]),e._v(" "),t("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传jpg/png/word文件，且不超过2M")])],1)],1),e._v(" "),t("el-form-item",{attrs:{label:"合同：",prop:"contract"}},[e.addClientData.contract?t("img",{staticStyle:{width:"220px",height:"400px"},attrs:{src:e.addClientData.contract,alt:"营业执照"}}):e._e(),e._v(" "),t("el-upload",{ref:"uploadFile2",attrs:{action:"",accept:".jpg, .png, .word","on-change":function(a,t){return e.fileChange(a,t,2)},"http-request":e.contractChange2,"file-list":e.fileList2,"on-success":e.contractsSize}},[t("el-button",[e._v("上传")]),e._v(" "),t("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传jpg/png/word文件，且不超过2M")])],1)],1)],1),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(a){e.resetForm("addClientData")}}},[e._v("取 消")]),e._v(" "),t("el-button",{attrs:{type:"primary"},on:{click:function(a){e.submitAddClientData(e.addClientData)}}},[e._v("确认添加")])],1)],1),e._v(" "),t("el-dialog",{ref:"modifyClientForm",attrs:{title:"修改客户申请",visible:e.modifyClientDataFlag,width:"500px"},on:{"update:visible":function(a){e.modifyClientDataFlag=a}}},[t("el-form",{ref:"modifyClientForm",staticStyle:{width:"450px"},attrs:{inline:"inline",model:e.modifyClientData,rules:e.rule1,"label-width":"120px",action:"#",encytype:"multipart/form-data"}},[t("el-form-item",{attrs:{label:"公司名称：",prop:"companyName"}},[t("el-input",{attrs:{placeholder:"请输入公司名称全程"},model:{value:e.modifyClientData.companyName,callback:function(a){e.$set(e.modifyClientData,"companyName",a)},expression:"modifyClientData.companyName"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"客户来源："}},[t("el-select",{attrs:{filterable:""},model:{value:e.modifyClientData.source,callback:function(a){e.$set(e.modifyClientData,"source",a)},expression:"modifyClientData.source"}},e._l(e.sourceOpt,function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),t("el-form-item",{attrs:{label:"账号类型："}},[t("el-select",{attrs:{filterable:""},model:{value:e.modifyClientData.accountTpye,callback:function(a){e.$set(e.modifyClientData,"accountTpye",a)},expression:"modifyClientData.accountTpye"}},e._l(e.accountTypeOpt,function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),t("el-form-item",{attrs:{label:"单价(元)：",prop:"unitprice"}},[t("el-input",{model:{value:e.modifyClientData.unitprice,callback:function(a){e.$set(e.modifyClientData,"unitprice",e._n(a))},expression:"modifyClientData.unitprice"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"联系人：",prop:"nickName"}},[t("el-input",{model:{value:e.modifyClientData.nickName,callback:function(a){e.$set(e.modifyClientData,"nickName",a)},expression:"modifyClientData.nickName"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"联系电话：",prop:"mobile"}},[t("el-input",{model:{value:e.modifyClientData.mobile,callback:function(a){e.$set(e.modifyClientData,"mobile",a)},expression:"modifyClientData.mobile"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"营业执照：",prop:"businessLicense"}},[e.modifyClientData.businessLicense?t("img",{staticStyle:{width:"220px",height:"400px"},attrs:{src:e.modifyClientData.businessLicense,alt:"营业执照"}}):e._e(),e._v(" "),t("el-upload",{ref:"uploadFile3",attrs:{action:"",accept:".jpg, .png, .word","on-change":function(a,t){return e.fileChange(a,t,3)},"http-request":e.businessLicenseChange1,"file-list":e.fileList3}},[t("el-button",[e._v("重新上传")]),e._v(" "),t("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传jpg/png/word文件，且不超过2M")])],1)],1),e._v(" "),t("el-form-item",{attrs:{label:"合同：",prop:"contract"}},[e.modifyClientData.contract?t("img",{staticStyle:{width:"220px",height:"400px"},attrs:{src:e.modifyClientData.contract,alt:"合同"}}):e._e(),e._v(" "),t("el-upload",{ref:"uploadFile4",attrs:{action:"",accept:".jpg, .png, .word","on-change":function(a,t){return e.fileChange(a,t,4)},"http-request":e.contractChange1,"file-list":e.fileList4}},[t("el-button",[e._v("重新上传")]),e._v(" "),t("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传jpg/png/word文件，且不超过2M")])],1)],1)],1),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(a){e.close("modifyClientData")}}},[e._v("取 消")]),e._v(" "),t("el-button",{attrs:{type:"primary"},on:{click:e.submitModifyClientData}},[e._v("确认修改")])],1)],1)],1)},staticRenderFns:[]};var d=t("VU/8")(c,u,!1,function(e){t("Asji")},"data-v-72c1a4e8",null);a.default=d.exports}});